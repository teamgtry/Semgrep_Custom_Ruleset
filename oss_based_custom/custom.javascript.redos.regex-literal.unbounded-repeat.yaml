rules:
  - id: custom.javascript.redos.regex-literal.unbounded-repeat
    languages:
      - javascript
      - typescript
    severity: ERROR
    message: >
      [Custom Rule] alternation(|)이 포함된 정규식 그룹이
      무한 반복(*, +, {n,}) 형태로 사용되고 있습니다.
      해당 정규식은 입력에 따라 지수적 백트래킹이
      발생할 수 있으며, ReDoS
      (정규식 기반 서비스 거부 공격)로 실제 악용될
      가능성이 높은 고위험 패턴입니다.
    metadata:
      category: security
      cwe: "CWE-1333"
      redos_type: unbounded
      exploitability: high
      pattern_focus: regex_structure
    patterns:
      - pattern-either:
          - pattern: const $NAME = $RE;
          - pattern: let $NAME = $RE;
          - pattern: var $NAME = $RE;
      - metavariable-regex:
          metavariable: $RE
          regex: ^\/.*\([^\/\n]*\|[^\/\n]*\)(?:[+*]|\{\d+,\}).*\/[gimsuy]*$